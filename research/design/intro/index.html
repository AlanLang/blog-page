<!DOCTYPE html>
<html lang="en">

<head>
  <meta content="width=device-width,initial-scale=1" name="viewport">
  <meta charset="utf-8">
  
<meta name="site" content="https:&#x2F;&#x2F;alanlang.me&#x2F;research&#x2F;design&#x2F;intro&#x2F;">
<meta name="keywords" content="code">
<meta name="description" content="">
<meta name="author" content="alanlang">
<meta http-equiv="x-dns-prefetch-control" content="on">
<!-- OG -->
<meta property="og:image" content="">
<meta property="og:description" content="">
<meta property="og:type" content="website">
<meta property="og:locale" content="zh_CN">
<meta property="og:site_name" content="Alan&#x27;s Blog">
<meta property="og:url" content="https:&#x2F;&#x2F;alanlang.me&#x2F;research&#x2F;design&#x2F;intro&#x2F;">
<meta property="og:title" content="设计模式入门 - Alan&#x27;s Blog">
<meta property="twitter:partner" content="ogwp">
<!-- /OG -->
<!-- twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="设计模式入门 - Alan&#x27;s Blog">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="">
<!-- /twitter -->  

  <title>设计模式入门 - Alan&#x27;s Blog</title>
  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">
  <link href="/assets/main.css" rel="stylesheet">
   
</head>

<body class="flex flex-col min-h-full">
  <nav class="flex justify-center items-center bg-zinc-700 py-2 " translate="no">
    <div class="inner flex justify-center items-center sm:justify-between flex-col sm:flex-row mx-1">
      <ul class="color-white flex flex-row justify-start gap-4">
        <li><a class="nav-link opacity-90 text-2xl" href="https:&#x2F;&#x2F;alanlang.me">Alan&#x27;s Blog</a></li>
      </ul>
      <ul class="color-white flex flex-row gap-3 md:gap-4 items-center text-base">
        <li> <a class="nav-link hidden" href="https:&#x2F;&#x2F;alanlang.me/books"> Books </a> </li>
        <li> <a class="nav-link" href="https:&#x2F;&#x2F;alanlang.me/codes"> Codes </a> </li>
        <li> <a class="nav-link" href="https:&#x2F;&#x2F;alanlang.me/research"> Research </a> </li>
        <li> <a class="nav-link" href="https:&#x2F;&#x2F;alanlang.me/practical"> Practical </a> </li>
        <li> <a class="nav-link" href="https:&#x2F;&#x2F;alanlang.me/now"> Now </a> </li>
      </ul>
    </div>
  </nav>
  <div class="flex flex-col flex-grow">
    <div class="flex justify-center flex-grow min-h-[calc(100vh-15rem)]">
      <div class="inner mb-2">
        <div class="mt-4 lg:mt-6">
          
<h1 class="title font-medium text-2xl sm:text-3xl">
  <a href="https:&#x2F;&#x2F;alanlang.me&#x2F;research&#x2F;design&#x2F;intro&#x2F;">
      设计模式入门
  </a>
</h1>
<div class="flex gap-4 items-center my-1">
 <time class="text-gray-500">2022-10-10</time>
</div>
<div class="prose lg:prose-xl max-w-full my-6">
  <h2 id="huan-ying-lai-dao-she-ji-mo-shi-shi-jie">欢迎来到设计模式世界</h2>
<p>在本章，你讲学到为何（以及如何）利用其他开发人员的经验与智慧。他们遭遇过相同的问题，也顺利地解决过这些问题。本章结束前，我们会看看设计模式的用户和优点，再看一些关键 OO 设计原则，并通过一个实例来了解模式是如何运作的。使用模式最好的方式是：“把模式装进脑子里，然后在你的设计和已有的应用中，寻找何处可以使用它们。”以往是代码复用，现在是经验复用。</p>
<h2 id="ya-zi-you-xi">鸭子游戏</h2>
<h3 id="xian-cong-jian-dan-de-mo-ni-ya-zi-ying-yong-zuo-qi">先从简单的模拟鸭子应用做起</h3>
<p>Joe 上班的工作做了一套相当成功的模拟鸭子游戏：SimUDuck，游戏中会出现各种鸭子，一边游泳戏水，一边呱呱叫。此系统内部设计使用的标准的 OO 技术，设计了一个鸭子超类（Superclass），并让各种鸭子继承此超类。</p>
<p><img src="https://vip2.loli.io/2022/10/10/SXVeqjD3gvNHJyC.jpg" alt="Xnip2022-10-10_21-20-26.jpg" /></p>
<p>但是虽然市面上出现了越来越多的鸭子游戏，公司的竞争压力加剧。公司主管认为该是创新的时候了，他们需要在“下周”股东会议上展示一些真正让人印象深刻的东西来振奋人心。</p>
<h3 id="xian-zai-wo-men-de-rang-ya-zi-neng-fei">现在我们得让鸭子能飞</h3>
<p>主管们确定，此模拟程序需要会飞的鸭子来将竞争者抛在后头。当然，在这个时候，Joe 的经理拍胸脯告诉主管们，Joe 只需要一个星期就可以搞定。“毕竟，Joe 是一个 OO 程序员⋯⋯这有什么困难？“</p>
<blockquote>
<p>Joe：我只需要在 Duck 类上加上 fly() 方法，然后所有的鸭子就都会继承 fly()。<br />
这是我大显身手，展示 OO 才华的时候了。</p>
</blockquote>
<p><img src="https://vip2.loli.io/2022/10/10/ofiV5b9Kvmgsprh.png" alt="SCR-20221010-tz0.png" /></p>
<h4 id="dan-shi-ke-pa-de-wen-ti-fa-sheng-liao">但是可怕的问题发生了</h4>
<p>领导突然给 Joe 打电话，说刚刚在股东会议上看了最新的演示，有很多“橡皮鸭子”在屏幕上飞来飞去，质问 Joe 究竟做了什么，感觉 Joe 要重新逛一逛求职网站了。
怎么回事？
Joe 忽略了一件事：并非 Duck 所有的子类都会飞。Joe 在 Duck 超类中加上新的行为，会使得某些并不适合该行为的子类也具有该行为。现在可好了 SimUDuck 程序中有了一个无生命的会飞的东西。对代码所做的局部修改，影响层面可不只是局部（会飞的橡皮鸭）！
Joy 体会到了一件事：<strong>当涉及“维护”时，为了“复用“（reuse）目的而使用继承，结局并不完美。</strong>
<img src="https://vip2.loli.io/2022/10/10/5crgP2fSvmbd4Re.png" alt="SCR-20221010-ua6.png" /></p>
<h4 id="joe-xiang-dao-liao-ji-cheng">Joe 想到了继承</h4>
<blockquote>
<p>Joe：我可以把橡皮鸭类中的 fly() 方法覆盖掉，就好像覆盖 quack() 的做法一样。。。。</p>
</blockquote>
<p><img src="https://vip2.loli.io/2022/10/10/6TPrCnLdwxYabz5.png" alt="SCR-20221010-uf8.png" /></p>
<blockquote>
<p>Joe：可是，如果以后我加入诱饵鸭（DecoyDuck），又会如何？
诱饵鸭是木头假鸭，不会飞也不会叫。。。。</p>
</blockquote>
<p><img src="https://vip2.loli.io/2022/10/10/e7ugPVZ6toBywOX.png" alt="SCR-20221010-uit.png" /></p>
<p>很显然，这样带来一个问题就是，每当 Joe 新增一种鸭子的时候，他都必须要想到这个鸭子是否会飞，从而决定是否需要重写 fly() 方法，这个系统是 Joy 自己开发的，所以他自己可能会想到，但是如果后面交给别人维护了呢？</p>
<h4 id="li-yong-jie-kou-ru-he">利用接口如何？</h4>
<p>Joe 认识到继承可能不是答案，因为每当有新的鸭子的子类出现，他就要被迫检查并可能需要覆盖 fly() 和 quack()，这简直就是无穷无尽的噩梦。
所以 Joe 又想到了利用接口</p>
<blockquote>
<p>Joe：我可以把 fly() 从超类中取出来，放进一个“Flyable 接口”中。这么一来，只有会飞的鸭子才实现此接口。同样的方式，也可以用来设计一个“Quackable 接口”，因为不是所有的鸭子都会叫。</p>
</blockquote>
<p><img src="https://vip2.loli.io/2022/10/12/b6WhQdjXLr3BU1t.png" alt="" />
大家觉得这个设计如何？我们 FVS 现在的组件类就是这种设计，说实话这种设计也不好。</p>
<p>当我新增一个鸭子子类时，我还是要想着要不要飞，如果要飞就去实现 Flyable，如果要叫就实现 Quackable。其次就是现在这两个方式都是放在子类里实现的，如果很多鸭子的 fly 的实现是相同的，就又会有很多重复代码。
所以这只能算是从一个噩梦跳进另一个噩梦。</p>
<h4 id="zhong-xin-kao-lu-zhe-ge-wen-ti">重新考虑这个问题</h4>
<p>现在我们知道使用继承并不能很好得解决问题，Flyable 和 Quackable 接口一开始似乎还挺不错，解决了橡皮鸭子会飞的问题（只有会飞的鸭子才实现 Flyable 接口），但是大多数编程需要都不能多继承，接口里不具有实现的代码，所以继承接口无法做到代码的复用。这意味着无论何时你需要修改某个行为，你必须往下追踪并在定义在此行为的类中修改它，一不小心可能会造成新的错误。幸运的是有一个设计原则恰好适用于此情况。</p>
<blockquote>
<p>设计原则
找出应用中可能需要变化之处，把它们独立出来，不要和那些不需要变化的代码混在一起。</p>
</blockquote>
<p>这是我们第一个设计原则，后面还会有更多原则在我们专栏中出现。
换句话说，如果每次新需求一来，都会使某方面的代码发生变化，那么就可以确定，这部分代码需要被抽出来，和其他稳定的代码有所区分。</p>
<h4 id="fen-kai-bian-hua-he-bu-bian-hua-de-bu-fen">分开变化和不变化的部分</h4>
<p>现在看起来，鸭子模型除了 fly() 和 quack() 之前其他地方还算正常，所以我们只需要把 fly() 和 quack() 作为变化的部分提取出来，其他部分还保持原来的样子。
为了分开“变化和不变化的部分”，我们准备建立两组类，一组和 fly() 相关，另一组和 quack() 相关。每一组类实现各自的动作。比如说对于 quack()，我们有一个类实现“呱呱叫”，有一个类实现“吱吱叫”，还有一个类实现“安静”。</p>
<h4 id="she-ji-ya-zi-de-xing-wei">设计鸭子的行为</h4>
<blockquote>
<p>设计原则
针对接口编程，而不是针对实现编程。</p>
</blockquote>
<p>我们利用接口代表每个行为，比方说我们设计 FlyBehavior 和 QuackBehavior，而行为的每个实现都将实现其中的一个接口。</p>
<p><img src="https://vip2.loli.io/2022/10/13/IXjJBmVAOy6leUR.png" alt="SCR-20221013-tkk.png" /></p>
<p>这样的设计，可以让飞行和呱呱叫的动作被其他的对象复用，因为这些行为已经和鸭子类无关了。
而我们可以新增一些行为，不会影响到既有的行为类，也不会影响到使用“飞行”行为类的鸭子类。</p>
<h4 id="zheng-he-ya-zi-de-xing-wei">整合鸭子的行为</h4>
<p>关键点在于，鸭子需要将飞行和呱呱叫的动作委托别人处理，而不是使用定义在 Duck 类或子类中的飞行和呱呱叫的方法。</p>
<p><img src="https://vip2.loli.io/2022/10/13/R7c2l5rVXns1W8F.png" alt="SCR-20221013-tmj.png" /></p>
<pre style="background-color:#f5f5f5;">
<code class="language-ts" data-lang="ts"><span style="color:#668f14;">interface </span><span style="color:#c23f31;">FlyBehavior </span><span style="color:#1f1f1f;">{
  </span><span style="color:#c23f31;">fly</span><span style="color:#72ab00;">: </span><span style="color:#1f1f1f;">() </span><span style="color:#668f14;">=&gt; </span><span style="color:#a2a001;">void</span><span style="color:#1f1f1f;">;
}

</span><span style="color:#668f14;">interface </span><span style="color:#c23f31;">QuackBehavior </span><span style="color:#1f1f1f;">{
  </span><span style="color:#c23f31;">quack</span><span style="color:#72ab00;">: </span><span style="color:#1f1f1f;">() </span><span style="color:#668f14;">=&gt; </span><span style="color:#a2a001;">void</span><span style="color:#1f1f1f;">;
}

</span><span style="color:#668f14;">abstract class </span><span style="color:#c23f31;">Duck </span><span style="color:#1f1f1f;">{
  </span><span style="color:#668f14;">protected </span><span style="color:#5597d6;">flyBehavior</span><span style="color:#72ab00;">: </span><span style="color:#c23f31;">FlyBehavior</span><span style="color:#1f1f1f;">;
  </span><span style="color:#668f14;">protected </span><span style="color:#5597d6;">quackBehavior</span><span style="color:#72ab00;">: </span><span style="color:#c23f31;">QuackBehavior</span><span style="color:#1f1f1f;">;

  </span><span style="color:#668f14;">public abstract </span><span style="color:#c23f31;">display</span><span style="color:#1f1f1f;">()</span><span style="color:#72ab00;">: </span><span style="color:#a2a001;">void</span><span style="color:#1f1f1f;">;
  </span><span style="color:#668f14;">public abstract </span><span style="color:#c23f31;">swim</span><span style="color:#1f1f1f;">()</span><span style="color:#72ab00;">: </span><span style="color:#a2a001;">void</span><span style="color:#1f1f1f;">;

  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">performFly</span><span style="color:#1f1f1f;">() {
    </span><span style="color:#5597d6;">this</span><span style="color:#1f1f1f;">.</span><span style="color:#5597d6;">flyBehavior</span><span style="color:#1f1f1f;">.</span><span style="color:#c23f31;">fly</span><span style="color:#1f1f1f;">();
  }

  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">performQuack</span><span style="color:#1f1f1f;">() {
    </span><span style="color:#5597d6;">this</span><span style="color:#1f1f1f;">.</span><span style="color:#5597d6;">quackBehavior</span><span style="color:#1f1f1f;">.</span><span style="color:#c23f31;">quack</span><span style="color:#1f1f1f;">();
  }
}
</span></code></pre>
<p>就拿呱呱叫这个需求举例，这样的话，每只鸭子都会引用实现 QuackBehavior 接口的对象，鸭子对象不会亲自处理呱呱叫行为，而是委托给 quackBehavior 引用的对象。
这样的话如果要实现一个绿头鸭就好是这样：</p>
<pre style="background-color:#f5f5f5;">
<code class="language-ts" data-lang="ts"><span style="color:#668f14;">class </span><span style="color:#c23f31;">Quack </span><span style="color:#668f14;">implements </span><span style="font-style:italic;color:#b06936;">QuackBehavior </span><span style="color:#1f1f1f;">{
  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">quack</span><span style="color:#1f1f1f;">() {
    </span><span style="color:#a2a001;">console</span><span style="color:#1f1f1f;">.</span><span style="color:#b39f04;">log</span><span style="color:#1f1f1f;">(</span><span style="color:#d07711;">&#39;呱呱叫&#39;</span><span style="color:#1f1f1f;">);
  }
}

</span><span style="color:#668f14;">class </span><span style="color:#c23f31;">FlyWithWings </span><span style="color:#668f14;">implements </span><span style="font-style:italic;color:#b06936;">FlyBehavior </span><span style="color:#1f1f1f;">{
  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">fly</span><span style="color:#1f1f1f;">() {
    </span><span style="color:#a2a001;">console</span><span style="color:#1f1f1f;">.</span><span style="color:#b39f04;">log</span><span style="color:#1f1f1f;">(</span><span style="color:#d07711;">&#39;使用翅膀飞&#39;</span><span style="color:#1f1f1f;">);
  }
}

</span><span style="color:#668f14;">class </span><span style="color:#c23f31;">MallardDuck </span><span style="color:#668f14;">extends </span><span style="font-style:italic;color:#b06936;">Duck </span><span style="color:#1f1f1f;">{
  </span><span style="color:#668f14;">public constructor</span><span style="color:#1f1f1f;">() {
    </span><span style="color:#5597d6;">super</span><span style="color:#1f1f1f;">();
    </span><span style="color:#5597d6;">this</span><span style="color:#1f1f1f;">.</span><span style="color:#5597d6;">quackBehavior </span><span style="color:#72ab00;">= new </span><span style="color:#c23f31;">Quack</span><span style="color:#1f1f1f;">();
    </span><span style="color:#5597d6;">this</span><span style="color:#1f1f1f;">.</span><span style="color:#5597d6;">flyBehavior </span><span style="color:#72ab00;">= new </span><span style="color:#c23f31;">FlyWithWings</span><span style="color:#1f1f1f;">();
  }

  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">display</span><span style="color:#1f1f1f;">()</span><span style="color:#72ab00;">: </span><span style="color:#a2a001;">void </span><span style="color:#1f1f1f;">{
    </span><span style="color:#a2a001;">console</span><span style="color:#1f1f1f;">.</span><span style="color:#b39f04;">log</span><span style="color:#1f1f1f;">(</span><span style="color:#d07711;">&#39;我是绿头鸭&#39;</span><span style="color:#1f1f1f;">);
  }
  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">swim</span><span style="color:#1f1f1f;">()</span><span style="color:#72ab00;">: </span><span style="color:#a2a001;">void </span><span style="color:#1f1f1f;">{
    </span><span style="color:#a2a001;">console</span><span style="color:#1f1f1f;">.</span><span style="color:#b39f04;">log</span><span style="color:#1f1f1f;">(</span><span style="color:#d07711;">&#39;我会游泳&#39;</span><span style="color:#1f1f1f;">);
  }
}
</span></code></pre>
<p>这样的话，绿头鸭真的“呱呱叫”，而不是“吱吱叫”，或“叫不出声”。这是怎么办到的？当 MallardDuck 实例化时，它的构造器会把继承来的 quackBehavior 实例变量初始化成 Quack 类型的新实例。同样的处理方式也用在了飞行行为上。
这时候有聪明的同学就会问了：
&gt;你不是说过我们将不对具体实现编程吗？当时我们在构造函数里做了什么呢？
&gt;我们正在制造一个具体的 Quack 实现类的实例！</p>
<p>没错，我们现在是这么做了，不过这只是暂时的，通过后面学习的知识，我们会修正这一个问题。
虽然我们现在在 Duck 的子类的构造函数里制造里具体的实例，但是但是我们目前的做法还是很有弹性的，既能解决继承带来的问题，又能处理鸭子子类代码复用的问题。
甚至在一些需求场景下，我们还能动态改变这些行为。</p>
<h4 id="rang-mo-xing-ya-zuo-huo-jian">让模型鸭坐火箭</h4>
<p>比如我们的鸭子游戏引入了装备系统，这样部分之前不能飞行的鸭子如果装备上飞行装备就会有飞行的能力。
首先在 Duck 类中，加入一个新方法：</p>
<pre style="background-color:#f5f5f5;">
<code class="language-ts" data-lang="ts"><span style="color:#5597d6;">public </span><span style="color:#c23f31;">setFlyBehavior</span><span style="color:#1f1f1f;">(</span><span style="color:#5597d6;">fb</span><span style="color:#1f1f1f;">: </span><span style="color:#5597d6;">FlyBehavior</span><span style="color:#1f1f1f;">) {
  </span><span style="color:#5597d6;">this</span><span style="color:#1f1f1f;">.</span><span style="color:#5597d6;">flyBehavior </span><span style="color:#72ab00;">= </span><span style="color:#5597d6;">fb</span><span style="color:#1f1f1f;">;
}
</span></code></pre>
<p>然后有一个模型鸭，一开始是不会飞的</p>
<pre style="background-color:#f5f5f5;">
<code class="language-ts" data-lang="ts"><span style="color:#668f14;">class </span><span style="color:#c23f31;">FlyNoWay </span><span style="color:#668f14;">implements </span><span style="font-style:italic;color:#b06936;">FlyBehavior </span><span style="color:#1f1f1f;">{
  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">fly</span><span style="color:#1f1f1f;">() {
    </span><span style="color:#a2a001;">console</span><span style="color:#1f1f1f;">.</span><span style="color:#b39f04;">log</span><span style="color:#1f1f1f;">(</span><span style="color:#d07711;">&#39;不会飞，什么也不做&#39;</span><span style="color:#1f1f1f;">);
  }
}

</span><span style="color:#668f14;">class </span><span style="color:#c23f31;">ModelDuck </span><span style="color:#668f14;">extends </span><span style="font-style:italic;color:#b06936;">Duck </span><span style="color:#1f1f1f;">{
  </span><span style="color:#668f14;">public constructor</span><span style="color:#1f1f1f;">() {
    </span><span style="color:#5597d6;">super</span><span style="color:#1f1f1f;">();
    </span><span style="color:#5597d6;">this</span><span style="color:#1f1f1f;">.</span><span style="color:#5597d6;">quackBehavior </span><span style="color:#72ab00;">= new </span><span style="color:#c23f31;">Quack</span><span style="color:#1f1f1f;">();
    </span><span style="color:#5597d6;">this</span><span style="color:#1f1f1f;">.</span><span style="color:#5597d6;">flyBehavior </span><span style="color:#72ab00;">= new </span><span style="color:#c23f31;">FlyNoWay</span><span style="color:#1f1f1f;">();
  }

  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">display</span><span style="color:#1f1f1f;">()</span><span style="color:#72ab00;">: </span><span style="color:#a2a001;">void </span><span style="color:#1f1f1f;">{
    </span><span style="color:#a2a001;">console</span><span style="color:#1f1f1f;">.</span><span style="color:#b39f04;">log</span><span style="color:#1f1f1f;">(</span><span style="color:#d07711;">&#39;我是模型鸭&#39;</span><span style="color:#1f1f1f;">);
  }
  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">swim</span><span style="color:#1f1f1f;">()</span><span style="color:#72ab00;">: </span><span style="color:#a2a001;">void </span><span style="color:#1f1f1f;">{
    </span><span style="color:#a2a001;">console</span><span style="color:#1f1f1f;">.</span><span style="color:#b39f04;">log</span><span style="color:#1f1f1f;">(</span><span style="color:#d07711;">&#39;我会游泳&#39;</span><span style="color:#1f1f1f;">);
  }
}
</span></code></pre>
<p>然后新建一个新的 FlyBehavior 类型：火箭飞行</p>
<pre style="background-color:#f5f5f5;">
<code class="language-ts" data-lang="ts"><span style="color:#668f14;">class </span><span style="color:#c23f31;">FlyRocketPowered </span><span style="color:#668f14;">implements </span><span style="font-style:italic;color:#b06936;">FlyBehavior </span><span style="color:#1f1f1f;">{
  </span><span style="color:#668f14;">public </span><span style="color:#c23f31;">fly</span><span style="color:#1f1f1f;">() {
    </span><span style="color:#a2a001;">console</span><span style="color:#1f1f1f;">.</span><span style="color:#b39f04;">log</span><span style="color:#1f1f1f;">(</span><span style="color:#d07711;">&#39;我可以坐火箭飞&#39;</span><span style="color:#1f1f1f;">);
  }
}
</span></code></pre>
<p>然后给模型鸭加上火箭动力</p>
<pre style="background-color:#f5f5f5;">
<code class="language-ts" data-lang="ts"><span style="color:#668f14;">const </span><span style="color:#5597d6;">modelDuck </span><span style="color:#72ab00;">= new </span><span style="color:#c23f31;">ModelDuck</span><span style="color:#1f1f1f;">();
</span><span style="color:#5597d6;">modelDuck</span><span style="color:#1f1f1f;">.</span><span style="color:#c23f31;">performFly</span><span style="color:#1f1f1f;">(); </span><span style="color:#7f8989;">//不会飞，什么也不做
</span><span style="color:#5597d6;">modelDuck</span><span style="color:#1f1f1f;">.</span><span style="color:#c23f31;">setFlyBehavior</span><span style="color:#1f1f1f;">(</span><span style="color:#72ab00;">new </span><span style="color:#c23f31;">FlyRocketPowered</span><span style="color:#1f1f1f;">());
</span><span style="color:#5597d6;">modelDuck</span><span style="color:#1f1f1f;">.</span><span style="color:#c23f31;">performFly</span><span style="color:#1f1f1f;">(); </span><span style="color:#7f8989;">//我可以坐火箭飞
</span></code></pre><h4 id="xian-zai-lai-kan-kan-zheng-ti-de-ge-ju">现在来看看整体的格局</h4>
<p><img src="https://vip2.loli.io/2022/10/13/dAZclQtFT9nUB6C.png" alt="SCR-20221013-tqm.png" />
如同本例一般，把两个类结合起来使用，这就是组合（composition）。这种做法和“继承”不同的地方在于，鸭子的行为不是继承来的，而是和适当的行为对象“组合”来的。</p>
<blockquote>
<p>设计原则<br />
多用组合，少用继承。</p>
</blockquote>
<p>组合用在了很多设计模式中，我们后面的课程中也会用到，你也会看到它的诸多优点和缺点。</p>
<h2 id="jiang-dao-she-ji-mo-shi">讲到设计模式</h2>
<p>刚刚我们就学到了我们第一个设计模式：策略模式（Strategy Pattern）</p>
<blockquote>
<p>策略模式<br />
定义了算法蔟，分别封装起来，让它们之间可以互相替换,<br />
此模式让算法的变化独立于使用算法的客户。</p>
</blockquote>
<p>那么，究竟什么是设计模式？是框架或者库吗？设计模式的好处是什么？
设计模式会提高程序的执行效率吗？不会。
那么设计模式会减少我们的代码量吗？不会。
那么设计模式会增加代码的可读性吗？不会。
那么设计模式有什么用？
大家可以想一下，平时我们编码花费最久也是最讨厌的事情是什么？软件开发完成“前”以及完成“后”，何者需要花费更多的时间呢？
答案是“后”，我们总是需要花许多时间在系统的维护和变化上，比原来开发花的时间更多。产品每时每刻都面临着改变。就是这些改变，给我们带来了很多痛苦。所以为了应对改变，我们也做了很多事情。比如我们会通过写单元测试，来保证代码修改后的正确性。而这些设计模式，就是一群有经验的人总结出来的方法。让我们能够在系统不断迭代的过程中尽量保证修改的便利性以及代码的稳定性。
SPOT（Single Point Of Truth，单点事实）。代码需要修改时，你只需要在一个地方修改，而不必改动多个地方。</p>
<h2 id="yao-dian">要点</h2>
<ul>
<li>知道 OO 基础并不足以让你设计出良好的 OO 系统。</li>
<li>良好的 OO 设计必须具备可复用，可扩充，可维护三个特性。</li>
<li>模式可以让我们建造出具有良好 OO 设计质量的系统。</li>
<li>模式被认为是历经验证的 OO 设计经验。</li>
<li>模式不是代码，而是针对设计问题的通用解决方案。你可以把它们应用到特定的应用中。</li>
<li>模式不是被发明，而是被发现。</li>
<li>大多数的模式和原则，都着眼于软件变化的主题。</li>
<li>大多数的模式都允许系统局部改变独立于其他部分。</li>
<li>我们常把系统中变化的部分抽出来封装。</li>
<li>模式让开发人员之间有共享的语言，能够最大化沟通的价值。</li>
</ul>
<h2 id="fu-lu">附录</h2>
<ul>
<li><a href="https://stackblitz.com/edit/typescript-ohdkxh?file=index.ts">本章涉及的代码</a></li>
</ul>

</div>



<div class="fixed flex-col top-0 bottom-0 right-0 left-[calc((100%-48rem)/2+50rem)] items-center justify-center hidden xl:flex">
  <nav class="docs-toc flex select-none items-center justify-center">
    <nav>
      <ul>
        
        <li><a data-id="huan-ying-lai-dao-she-ji-mo-shi-shi-jie" class="docs-toc-item text-xs opacity-50 transition-opacity duration-300" href="https://alanlang.me/research/design/intro/#huan-ying-lai-dao-she-ji-mo-shi-shi-jie">欢迎来到设计模式世界</a></li>
        
        
        <li><a data-id="ya-zi-you-xi" class="docs-toc-item text-xs opacity-50 transition-opacity duration-300" href="https://alanlang.me/research/design/intro/#ya-zi-you-xi">鸭子游戏</a></li>
        
        <ul>
          
          <li><a data-id="xian-cong-jian-dan-de-mo-ni-ya-zi-ying-yong-zuo-qi" class="docs-toc-item text-xs ml-2 opacity-50 transition-opacity duration-300" href="https://alanlang.me/research/design/intro/#xian-cong-jian-dan-de-mo-ni-ya-zi-ying-yong-zuo-qi">先从简单的模拟鸭子应用做起</a></li>
          
          <li><a data-id="xian-zai-wo-men-de-rang-ya-zi-neng-fei" class="docs-toc-item text-xs ml-2 opacity-50 transition-opacity duration-300" href="https://alanlang.me/research/design/intro/#xian-zai-wo-men-de-rang-ya-zi-neng-fei">现在我们得让鸭子能飞</a></li>
          
        </ul>
        
        
        <li><a data-id="jiang-dao-she-ji-mo-shi" class="docs-toc-item text-xs opacity-50 transition-opacity duration-300" href="https://alanlang.me/research/design/intro/#jiang-dao-she-ji-mo-shi">讲到设计模式</a></li>
        
        
        <li><a data-id="yao-dian" class="docs-toc-item text-xs opacity-50 transition-opacity duration-300" href="https://alanlang.me/research/design/intro/#yao-dian">要点</a></li>
        
        
        <li><a data-id="fu-lu" class="docs-toc-item text-xs opacity-50 transition-opacity duration-300" href="https://alanlang.me/research/design/intro/#fu-lu">附录</a></li>
        
        
      </ul>
    </nav>
  </nav>
</div>


        </div>
      </div>
    </div>
    
<div class="mt-4 mb-6 flex flex-row items-center justify-center">
  <svg id="loading" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; display: block;" width="34px" height="34px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
    <defs>
      <clipPath id="ldio-h4a348o36ew-cp">
        <rect x="0" y="0" width="100" height="50">
          <animate attributeName="y" repeatCount="indefinite" dur="2.2222222222222223s" calcMode="spline" values="0;50;0;0;0" keyTimes="0;0.4;0.5;0.9;1" keySplines="0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7"></animate>
          <animate attributeName="height" repeatCount="indefinite" dur="2.2222222222222223s" calcMode="spline" values="50;0;0;50;50" keyTimes="0;0.4;0.5;0.9;1" keySplines="0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7"></animate>
        </rect>
        <rect x="0" y="50" width="100" height="50">
          <animate attributeName="y" repeatCount="indefinite" dur="2.2222222222222223s" calcMode="spline" values="100;50;50;50;50" keyTimes="0;0.4;0.5;0.9;1" keySplines="0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7"></animate>
          <animate attributeName="height" repeatCount="indefinite" dur="2.2222222222222223s" calcMode="spline" values="0;50;50;0;0" keyTimes="0;0.4;0.5;0.9;1" keySplines="0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7"></animate>
        </rect>
      </clipPath>
    </defs>
    <g transform="translate(50 50)"><g transform="scale(0.9)"><g transform="translate(-50 -50)">
      <g>
        <animateTransform attributeName="transform" type="rotate" dur="2.2222222222222223s" repeatCount="indefinite" values="0 50 50;0 50 50;180 50 50;180 50 50;360 50 50" keyTimes="0;0.4;0.5;0.9;1"></animateTransform>
        <path clip-path="url(#ldio-h4a348o36ew-cp)" fill="#5699d2" d="M54.864 50L54.864 50c0-1.291 0.689-2.412 1.671-2.729c9.624-3.107 17.154-12.911 19.347-25.296 c0.681-3.844-1.698-7.475-4.791-7.475H28.908c-3.093 0-5.472 3.631-4.791 7.475c2.194 12.385 9.723 22.189 19.347 25.296 c0.982 0.317 1.671 1.438 1.671 2.729v0c0 1.291-0.689 2.412-1.671 2.729C33.84 55.836 26.311 65.64 24.117 78.025 c-0.681 3.844 1.698 7.475 4.791 7.475h42.184c3.093 0 5.472-3.631 4.791-7.475C73.689 65.64 66.16 55.836 56.536 52.729 C55.553 52.412 54.864 51.291 54.864 50z"></path>
        <path fill="#1d3f72" d="M81 81.5h-2.724l0.091-0.578c0.178-1.122 0.17-2.243-0.022-3.333C76.013 64.42 68.103 54.033 57.703 50.483l-0.339-0.116 v-0.715l0.339-0.135c10.399-3.552 18.31-13.938 20.642-27.107c0.192-1.089 0.2-2.211 0.022-3.333L78.276 18.5H81 c2.481 0 4.5-2.019 4.5-4.5S83.481 9.5 81 9.5H19c-2.481 0-4.5 2.019-4.5 4.5s2.019 4.5 4.5 4.5h2.724l-0.092 0.578 c-0.178 1.122-0.17 2.243 0.023 3.333c2.333 13.168 10.242 23.555 20.642 27.107l0.338 0.116v0.715l-0.338 0.135 c-10.4 3.551-18.31 13.938-20.642 27.106c-0.193 1.09-0.201 2.211-0.023 3.333l0.092 0.578H19c-2.481 0-4.5 2.019-4.5 4.5 s2.019 4.5 4.5 4.5h62c2.481 0 4.5-2.019 4.5-4.5S83.481 81.5 81 81.5z M73.14 81.191L73.012 81.5H26.988l-0.128-0.309 c-0.244-0.588-0.491-1.538-0.28-2.729c2.014-11.375 8.944-20.542 17.654-23.354c2.035-0.658 3.402-2.711 3.402-5.108 c0-2.398-1.368-4.451-3.403-5.108c-8.71-2.812-15.639-11.979-17.653-23.353c-0.211-1.191 0.036-2.143 0.281-2.731l0.128-0.308 h46.024l0.128 0.308c0.244 0.589 0.492 1.541 0.281 2.731c-2.015 11.375-8.944 20.541-17.654 23.353 c-2.035 0.658-3.402 2.71-3.402 5.108c0 2.397 1.368 4.45 3.403 5.108c8.71 2.812 15.64 11.979 17.653 23.354 C73.632 79.651 73.384 80.604 73.14 81.191z"></path>
      </g>
    </g></g></g>
  </svg>
  <div id="like-btn" class="text-gray-400 hidden rounded-full border border-gray-300 p-1 px-3 flex flex-row items-center gap-2 cursor-pointer disabled">
    <p> 👍 </p>
    <p class="text-sm hidden" id="like-count" style="display: block;"></p>
  </div>
</div>


    <footer class="flex border-t border-gray-300 text-gray-600 bg-gray-50 items-center justify-center text-sm mt-1" translate="no">
      <div class="flex flex-col inner justify-center items-center gap-2 pt-6 pb-4">
        <p> Be curious. Read widely. Try new things. -- Aaron Swartz </p>
        <p> alanlang.me@gmail.com </p>
        <ul>
          <li class="flex flex-row gap-2">
            <a class="underline" href="https:&#x2F;&#x2F;alanlang.me/archives">Archives</a>
            <a class="underline" href="https:&#x2F;&#x2F;alanlang.me/categories">Categories</a>
            <a class="underline" href="https:&#x2F;&#x2F;alanlang.me/tags">Tags</a>
          </li>
        </ul>
        <p><a class="underline" href="https:&#x2F;&#x2F;alanlang.me/atom.xml">RSS</a></p>
        <p>2022 - Present</p>
      </div>
    </footer>
  </div>
  
<script defer type="text/javascript" src="/assets/main.js"></script>

</body>

</html>
